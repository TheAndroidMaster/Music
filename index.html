<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="generator" content="Music" />
  <title>Music</title>

  <meta name="theme-color" content="#FFFFFF">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="manifest" href="/manifest.json">

  <meta name="application-name" content="Music">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="msapplication-tooltip" content="James Fenn">
  <meta name="msapplication-config" content="/ieconfig.xml">

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="icon" sizes="16x16" href="/favicon.ico">
  <link rel="icon" sizes="24x24" href="/images/favicon-24.ico">
  <link rel="icon" sizes="32x32" href="/images/favicon-32.ico">
  <link rel="icon" sizes="48x48" href="/images/favicon-48.ico">
  <link rel="icon" sizes="64x64" href="/images/favicon-48.ico">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Music">
  <link rel="apple-touch-icon-precomposed" href="/images/favicon-152.png">

	<link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">

	<style>
		header {
			padding: 10px 20px;
			box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.3);
    	background-color: #FFF;
		}

		#playbar {
			position: fixed;
			bottom: 0;
			left: 0;
			right: 0;
			height: 100px;
			background-color: #212121;
			padding: 0 24px;
			overflow: hidden;
			white-space: nowrap;
		}

		#playbar * {
			color: #FFF;
			display: inline-block;
			position: absolute;
			bottom: 50%;
			transform: translateY(50%);
			margin: 0;
		}

		#controls {
			width: 100%;
			height: 64px;
			white-space: nowrap;
			position: relative;
			bottom: 0;
		}

		#controls>i {
			right: 0;
			cursor: pointer;
		}

		#progress {
			width: 100%;
			height: 4px;
			position: absolute;
			bottom: 0;
			left: 0;
			right: 0;
			transform: none;
			background-color: rgba(255, 255, 255, 0.3);
		}

		#progressBar {
			width: 50%;
			height: 4px;
			position: absolute;
			bottom: 0;
			left: 0;
			transform: none;
			background-color: #FFF;
		}

		#links {
			top: 0;
			bottom: auto;
			right: auto;
		}

		#links * {
			position: relative;
			transform: none;
		}

		@media screen and (min-width: 800px) {
			header {
				background: linear-gradient(to right, #FFF, transparent), url(images/piano.jpg), #FFF;
				background-repeat: no-repeat;
	      background-size: 178vh 100vh, auto 100vh, 100%;
	      background-position: center right;
				padding: 30px 50px;
				padding-right: calc(200px + 30%);
				min-height: 300px;
				margin-bottom: 20px;
			}

			#playbar {
				margin: 20px;
				width: 400px;
				left: auto;
				border-radius: 4px;
				box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
			}
		}
	</style>
</head>
<body>
	<header>
		<h1>Piano Music</h1>
		<p>
			Something something something <a>link</a> something something
			something something something something <a>link</a> something
			something something something something something <a>link</a>
			<a>link</a> something something something something something
			something <a>link</a> something something something something
			something something <a>link</a> something something something.
		</p>
	</header>
	<main>
		<div id="compositions" class="row"></div>
		<div id="practice" class="row"></div>
		<div id="playbar" style="display: none;">
			<div id="links">
				<a id="viewPdf">View Score</a>&nbsp;&nbsp;
				<a id="downloadAudio">Download Audio</a>
			</div>
			<div id="controls">
				<h1 id="name">Name</h1>
				<i id="play" class="material-icons" style="display: none;" onclick="playAudio();">play_arrow</i>
				<i id="pause" class="material-icons" onclick="pauseAudio();">pause</i>
			</div>
			<div id="progress">
				<div id="progressBar"></div>
			</div>
		</div>
	</main>
	<script type="text/javascript" src="js/data.js"></script>
	<script type="text/javascript">
		var compositions = document.getElementById("compositions");
		var practice = document.getElementById("practice");
		var playbar = document.getElementById("playbar");
		var nameTitle = document.getElementById("name");
		var viewPdf = document.getElementById("viewPdf");
		var downloadAudio = document.getElementById("downloadAudio");
		var play = document.getElementById("play");
		var pause = document.getElementById("pause");
		var progressBar = document.getElementById("progressBar");

		loadCompositions(compositions);
		loadPractice(practice);

		var isPlayBar;

		function onPlay(data) {
			if (data) {
				nameTitle.innerHTML = data.name;
				var pdf = function() {
					location.href = "compositions/" + data.id + "/score.pdf";
				};

				nameTitle.onclick = pdf;
				viewPdf.onclick = pdf;
				downloadAudio.href = "download:compositions/" + data.id + "/audio.wav";
			}

			playbar.style.display = "block";
			play.style.display = "none";
			pause.style.display = "inline-block";

			isPlayBar = true;
		}

		function onPause() {
			play.style.display = "inline-block";
			pause.style.display = "none";
		}

		function onTimeUpdate(currentTime, duration) {
			if (currentTime != duration) {
				progressBar.style.width = (currentTime * 100 / duration) + "%";
			} else if (isPlayBar) {
				playbar.style.display = "none";
				isPlayBar = false;
			}
		}
	</script>
</body>
</html>
